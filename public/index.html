<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>自动访问系统管理</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <!-- 登录页面 -->
    <div id="loginPage" class="page active">
        <div class="login-container">
            <div class="login-card">
                <div class="login-header">
                    <i class="fas fa-lock"></i>
                    <h1>自动访问系统登录</h1>
                    <p>请输入用户名和密码</p>
                </div>
                <form id="loginForm">
                    <div class="input-group">
                        <i class="fas fa-user"></i>
                        <input type="text" id="username" placeholder="请输入用户名" required>
                    </div>
                    <div class="input-group">
                        <i class="fas fa-key"></i>
                        <input type="password" id="password" placeholder="请输入密码" required>
                    </div>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-sign-in-alt"></i>
                        登录
                    </button>
                </form>
                <div id="loginError" class="error-message"></div>
            </div>
        </div>
    </div>

    <!-- 管理界面 -->
    <div id="mainPage" class="page">
        <!-- 导航栏 -->
        <nav class="navbar">
            <div class="nav-brand">
                <i class="fas fa-globe"></i>
                <span>自动访问系统</span>
            </div>
            <div class="nav-menu">
                <button class="nav-item active" data-tab="urls">
                    <i class="fas fa-link"></i>
                    URL管理
                </button>
                                 <button class="nav-item" data-tab="logs">
                     <i class="fas fa-history"></i>
                     访问日志
                 </button>
                 <button class="nav-item" data-tab="telegram">
                     <i class="fas fa-paper-plane"></i>
                     Telegram配置
                 </button>
                <button class="nav-item logout-btn" id="logoutBtn">
                    <i class="fas fa-sign-out-alt"></i>
                    退出登录
                </button>
            </div>
        </nav>

        <!-- URL管理页面 -->
        <div id="urlsTab" class="tab-content active">
            <div class="container">
                <div class="section-header">
                    <h2><i class="fas fa-link"></i> URL管理</h2>
                    <button class="btn btn-primary" id="addUrlBtn">
                        <i class="fas fa-plus"></i>
                        添加URL
                    </button>
                </div>

                <!-- 添加URL表单 -->
                <div id="addUrlForm" class="form-container" style="display: none;">
                    <div class="form-card">
                        <h3><i class="fas fa-plus-circle"></i> 添加新URL</h3>
                        
                        <!-- 添加模式切换 -->
                        <div class="add-mode-toggle">
                            <button type="button" class="mode-btn active" data-mode="single">
                                <i class="fas fa-plus"></i> 单个添加
                            </button>
                            <button type="button" class="mode-btn" data-mode="batch">
                                <i class="fas fa-list"></i> 批量添加
                            </button>
                        </div>
                        
                        <!-- 单个添加表单 -->
                        <form id="urlForm" class="add-form active">
                            <div class="form-row">
                                <div class="input-group">
                                    <label for="urlInput">URL地址</label>
                                    <input type="url" id="urlInput" placeholder="https://example.com" required>
                                </div>
                                <div class="input-group">
                                    <label for="accessMode">访问模式</label>
                                    <select id="accessMode" required>
                                        <option value="24h">24小时访问(每2分钟)</option>
                                        <option value="scheduled">定时访问(每2分钟,1:00-6:00暂停)</option>
                                    </select>
                                    <small style="color: #666; margin-top: 5px; display: block;">选择访问模式</small>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="input-group">
                                    <label for="descriptionInput">备注（可选）</label>
                                    <input type="text" id="descriptionInput" placeholder="URL备注">
                                </div>
                                <div class="input-group">
                                    <label>状态</label>
                                    <label class="switch">
                                        <input type="checkbox" id="enabledInput" checked>
                                        <span class="slider"></span>
                                    </label>
                                </div>
                            </div>
                            <div class="form-actions">
                                <button type="button" class="btn btn-secondary" id="cancelAddBtn">取消</button>
                                <button type="submit" class="btn btn-primary">保存</button>
                            </div>
                        </form>
                        
                        <!-- 批量添加表单 -->
                        <form id="batchUrlForm" class="add-form">
                            <div class="form-row">
                                <div class="input-group">
                                    <label for="batchUrlsInput">批量URL地址</label>
                                                                                 <textarea id="batchUrlsInput" placeholder="每行一个URL，格式：URL|备注（可选）&#10;例如：&#10;https://example1.com|网站1备注&#10;https://example2.com" rows="5" required></textarea>
                                             <small style="color: #666; margin-top: 5px; display: block;">每行一个URL，用|分隔URL和备注（备注可选）</small>
                                </div>
                                <div class="input-group">
                                    <label for="batchAccessMode">访问模式</label>
                                    <select id="batchAccessMode" required>
                                        <option value="24h">24小时访问(每2分钟)</option>
                                        <option value="scheduled">定时访问(每2分钟,1:00-6:00暂停)</option>
                                    </select>
                                    <small style="color: #666; margin-top: 5px; display: block;">批量设置所有URL的访问模式</small>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="input-group">
                                    <label>状态</label>
                                    <label class="switch">
                                        <input type="checkbox" id="batchEnabledInput" checked>
                                        <span class="slider"></span>
                                    </label>
                                </div>
                                <div class="input-group">
                                    <button type="button" class="btn btn-secondary" id="previewBatchBtn">
                                        <i class="fas fa-eye"></i> 预览
                                    </button>
                                </div>
                            </div>
                            <div class="form-actions">
                                <button type="button" class="btn btn-secondary" id="cancelAddBtn">取消</button>
                                <button type="submit" class="btn btn-primary">批量保存</button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- URL列表 -->
                <div class="urls-list">
                    <div class="list-header">
                        <div class="stats-row">
                            <div class="stat-item">
                                <span class="stat-number" id="totalUrls">0</span>
                                <span class="stat-label">总URL数</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number" id="activeUrls">0</span>
                                <span class="stat-label">活跃URL</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number" id="totalRequests">0</span>
                                <span class="stat-label">总请求数</span>
                            </div>
                        </div>
                    </div>
                    <div id="urlsList" class="urls-container">
                        <!-- URL项目将在这里动态添加 -->
                    </div>
                </div>
            </div>
        </div>

                                          <!-- 访问日志页面 -->
                 <div id="logsTab" class="tab-content">
                     <div class="container">
                         <div class="section-header">
                             <h2><i class="fas fa-history"></i> 访问日志</h2>
                             <div class="log-controls">
                                 <button class="btn btn-secondary" id="refreshLogsBtn">
                                     <i class="fas fa-sync"></i>
                                     刷新
                                 </button>
                                 <button class="btn btn-danger" id="clearLogsBtn">
                                     <i class="fas fa-trash"></i>
                                     清空日志
                                 </button>
                             </div>
                         </div>
                         
                         <!-- 日志过滤器 -->
                         <div class="log-filters">
                             <div class="filter-group">
                                 <label for="dateFilter">日期过滤</label>
                                 <input type="date" id="dateFilter">
                             </div>
                             <div class="filter-group">
                                 <label for="statusFilter">状态过滤</label>
                                 <select id="statusFilter">
                                     <option value="">全部</option>
                                     <option value="success">成功</option>
                                     <option value="error">错误</option>
                                 </select>
                             </div>
                             <div class="filter-group">
                                 <label for="urlFilter">URL过滤</label>
                                 <input type="text" id="urlFilter" placeholder="输入URL关键词">
                             </div>
                         </div>
                         
                         <!-- 日志列表 -->
                         <div id="logsList" class="logs-container">
                             <!-- 日志条目将在这里动态添加 -->
                         </div>
                     </div>
                 </div>
                 
                 <!-- Telegram配置页面 -->
                 <div id="telegramTab" class="tab-content">
                     <div class="container">
                         <div class="section-header">
                             <h2><i class="fas fa-paper-plane"></i> Telegram配置</h2>
                             <div class="telegram-controls">
                                 <button class="btn btn-secondary" id="refreshTelegramStatusBtn">
                                     <i class="fas fa-sync"></i>
                                     刷新状态
                                 </button>
                             </div>
                         </div>
                         
                         <!-- Telegram状态显示 -->
                         <div class="telegram-status-card">
                             <div class="status-header">
                                 <h3><i class="fas fa-info-circle"></i> 当前状态</h3>
                             </div>
                             <div class="status-content">
                                 <div class="status-item">
                                     <span class="status-label">Telegram提醒:</span>
                                     <span class="status-value" id="telegramStatus">检查中...</span>
                                 </div>
                                 <div class="status-item">
                                     <span class="status-label">Chat ID:</span>
                                     <span class="status-value" id="chatIdStatus">检查中...</span>
                                 </div>
                                 <div class="status-item">
                                     <span class="status-label">Bot Token:</span>
                                     <span class="status-value" id="botTokenStatus">检查中...</span>
                                 </div>
                             </div>
                         </div>
                         
                         <!-- Telegram推送控制 -->
                         <div class="telegram-control-card">
                             <div class="control-header">
                                 <h3><i class="fas fa-bell"></i> 推送控制</h3>
                             </div>
                             <div class="control-content">
                                 <div class="control-item">
                                     <span class="control-label">错误提醒推送:</span>
                                     <div class="control-actions">
                                         <button class="btn btn-success" id="enablePushBtn" style="display: none;">
                                             <i class="fas fa-play"></i> 启用推送
                                         </button>
                                         <button class="btn btn-warning" id="disablePushBtn" style="display: none;">
                                             <i class="fas fa-pause"></i> 暂停推送
                                         </button>
                                         <span class="control-status" id="controlStatus">检查中...</span>
                                     </div>
                                 </div>
                                 <div class="control-description">
                                     <small style="color: #2c2b2b;">
                                         <i class="fas fa-info-circle"></i>
                                         暂停推送后，系统仍会记录错误日志，但不会发送Telegram提醒消息
                                     </small>
                                 </div>
                             </div>
                         </div>
                         
                         <!-- Telegram配置表单 -->
                         <div class="telegram-config-card">
                             <div class="config-header">
                                 <h3><i class="fas fa-cog"></i> 配置设置</h3>
                             </div>
                             <form id="telegramConfigForm" class="telegram-form">
                                 <div class="form-row">
                                     <div class="input-group">
                                         <label for="telegramChatId">Chat ID</label>
                                         <input type="text" id="telegramChatId" placeholder="例如: 123456789" required>
                                         <small style="color: #313030; margin-top: 5px; display: block;">
                                             你的Telegram用户ID或群组ID
                                         </small>
                                     </div>
                                     <div class="input-group">
                                         <label for="telegramBotToken">Bot Token</label>
                                         <input type="text" id="telegramBotToken" placeholder="例如: 1234567890:ABCdefGHIjklMNOpqrsTUVwxyz" required>
                                         <small style="color: #313030; margin-top: 5px; display: block;">
                                             从@BotFather获取的机器人Token
                                         </small>
                                     </div>
                                 </div>
                                 <div class="form-actions">
                                     <button type="button" class="btn btn-danger" id="clearTelegramConfigBtn">
                                         <i class="fas fa-trash"></i> 清除配置
                                     </button>
                                     <button type="submit" class="btn btn-primary">
                                         <i class="fas fa-save"></i> 保存配置
                                     </button>
                                 </div>
                             </form>
                         </div>
                         
                         <!-- 配置说明 -->
                         <div class="telegram-help-card">
                             <div class="help-header">
                                 <h3><i class="fas fa-question-circle"></i> 配置说明</h3>
                             </div>
                             <div class="help-content">
                                 <h4>如何获取Chat ID和Bot Token？</h4>
                                 <ol>
                                     <li><strong>创建机器人:</strong> 在Telegram中搜索 @BotFather，发送 /newbot 命令</li>
                                     <li><strong>获取Token:</strong> 创建成功后，BotFather会发送给你一个token</li>
                                     <li><strong>获取Chat ID:</strong> 将机器人添加到群组或私聊，发送消息后访问：<br>
                                         <code>https://api.telegram.org/bot&lt;YOUR_BOT_TOKEN&gt;/getUpdates</code></li>
                                     <li><strong>找到Chat ID:</strong> 在返回的JSON中找到 chat.id 字段</li>
                                 </ol>
                                 <p><strong>注意:</strong> 配置成功后，系统会自动发送一条测试消息确认配置生效。</p>
                             </div>
                         </div>
                     </div>
                 </div>
    </div>

    <!-- 确认对话框 -->
    <div id="confirmModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="confirmTitle">确认操作</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <p id="confirmMessage">确定要执行此操作吗？</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="confirmCancel">取消</button>
                <button class="btn btn-primary" id="confirmOk">确认</button>
            </div>
        </div>
    </div>

    <!-- 批量添加预览对话框 -->
    <div id="previewModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-eye"></i> 批量添加预览</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div id="previewContent">
                    <!-- 预览内容将在这里动态添加 -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="previewCancel">返回编辑</button>
                <button class="btn btn-primary" id="previewConfirm">确认添加</button>
            </div>
        </div>
    </div>

    <!-- 编辑URL对话框 -->
    <div id="editUrlModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-edit"></i> 编辑URL</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <form id="editUrlForm">
                    <div class="form-row">
                        <div class="input-group">
                            <label for="editUrlInput">URL地址</label>
                            <input type="url" id="editUrlInput" placeholder="https://example.com" required>
                        </div>
                        <div class="input-group">
                            <label for="editAccessMode">访问模式</label>
                            <select id="editAccessMode" required>
                                <option value="24h">24小时访问(每2分钟)</option>
                                <option value="scheduled">定时访问(每2分钟,1:00-6:00暂停)</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="input-group">
                            <label for="editDescriptionInput">备注（可选）</label>
                            <input type="text" id="editDescriptionInput" placeholder="URL备注">
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="editUrlCancel">取消</button>
                <button class="btn btn-primary" id="editUrlSave">保存</button>
            </div>
        </div>
    </div>

    <!-- 通知提示 -->
    <div id="notification" class="notification">
        <div class="notification-content">
            <i class="notification-icon"></i>
            <span class="notification-message"></span>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
